import { Vec3 } from "../Vec.js";
import { lerp } from "../Util.js";

type Vec3Lookup = [number, Vec3][];

export default class ColourConverter {
  static tripletFromWavelength(wavelength: number): Vec3 {
    return this.lerpVec3FromLookup(ColourConverter.wavelengthToXYZ2012, wavelength);
  }

  static lerpVec3FromLookup(lookup: Vec3Lookup, valueToFind: number): Vec3 {
    if (valueToFind <= lookup[0][0]) {
      return lookup[0][1];
    }

    if (valueToFind >= lookup[lookup.length - 1][0]) {
      return lookup[lookup.length - 1][1];
    }

    const highIndex = lookup.findIndex(lookupItem => lookupItem[0] > valueToFind);
    const lowIndex = highIndex - 1;

    const lowLookupValue = lookup[lowIndex][0];
    const highLookupValue = lookup[highIndex][0];
    const difference = highLookupValue - lowLookupValue;
    const mix = (valueToFind - lowLookupValue) / difference;
    const lowValue = lookup[lowIndex][1];
    const highValue = lookup[highIndex][1];
    return new Vec3(
      lerp(lowValue.x, highValue.x, mix),
      lerp(lowValue.y, highValue.y, mix),
      lerp(lowValue.z, highValue.z, mix),
    );
  }

  // static xyzToRec709(xyz: Vec3, adapt = true): Vec3 {
  //   if (!adapt) {
  //     const red = (3.2404542 * xyz.x) + (-1.5371385 * xyz.y) + (-0.4985314 * xyz.z);
  //     const green = (-0.9692660 * xyz.x) + (1.8760108 * xyz.y) + (0.0415560 * xyz.z);
  //     const blue = (0.0556434 * xyz.x) + (-0.2040259 * xyz.y) + (1.0572252 * xyz.z);
  //     return new Vec3(red, green, blue);
  //   }

  //   const adaptedX = (0.9531874 * xyz.x) + (-0.0265906 * xyz.y) + (0.0238731 * xyz.z);
  //   const adaptedY = (-0.0382467 * xyz.x) + (1.0288406 * xyz.y) + (0.0094060 * xyz.z);
  //   const adaptedZ = (0.0026068 * xyz.x) + (-0.0030332 * xyz.y) + (1.0892565 * xyz.z);

  //   const red = (3.2404542 * adaptedX) + (-1.5371385 * adaptedY) + (-0.4985314 * adaptedZ);
  //   const green = (-0.9692660 * adaptedX) + (1.8760108 * adaptedY) + (0.0415560 * adaptedZ);
  //   const blue = (0.0556434 * adaptedX) + (-0.2040259 * adaptedY) + (1.0572252 * adaptedZ);
  //   return new Vec3(red, green, blue);
  // }

  // static xyzToxyY(xyz: Vec3): Vec3 {
  //   const x = xyz.x / (xyz.x + xyz.y + xyz.z);
  //   const y = xyz.y / (xyz.x + xyz.y + xyz.z);
  //   const Y = xyz.y;
  //   return new Vec3(x, y, Y);
  // }

  static wavelengthToXYZ1931: Vec3Lookup = [
    [380.0, new Vec3(0.0014, 0.0000, 0.0065)],
    [381.0, new Vec3(0.0015, 0.0000, 0.0070)],
    [382.0, new Vec3(0.0016, 0.0000, 0.0077)],
    [383.0, new Vec3(0.0018, 0.0001, 0.0085)],
    [384.0, new Vec3(0.0020, 0.0001, 0.0094)],
    [385.0, new Vec3(0.0022, 0.0001, 0.0105)],
    [386.0, new Vec3(0.0025, 0.0001, 0.0120)],
    [387.0, new Vec3(0.0029, 0.0001, 0.0136)],
    [388.0, new Vec3(0.0033, 0.0001, 0.0155)],
    [389.0, new Vec3(0.0037, 0.0001, 0.0177)],
    [390.0, new Vec3(0.0042, 0.0001, 0.0201)],
    [391.0, new Vec3(0.0048, 0.0001, 0.0225)],
    [392.0, new Vec3(0.0053, 0.0002, 0.0252)],
    [393.0, new Vec3(0.0060, 0.0002, 0.0284)],
    [394.0, new Vec3(0.0068, 0.0002, 0.0320)],
    [395.0, new Vec3(0.0077, 0.0002, 0.0362)],
    [396.0, new Vec3(0.0088, 0.0002, 0.0415)],
    [397.0, new Vec3(0.0100, 0.0003, 0.0473)],
    [398.0, new Vec3(0.0113, 0.0003, 0.0536)],
    [399.0, new Vec3(0.0128, 0.0004, 0.0605)],
    [400.0, new Vec3(0.0143, 0.0004, 0.0679)],
    [401.0, new Vec3(0.0156, 0.0004, 0.0741)],
    [402.0, new Vec3(0.0171, 0.0005, 0.0810)],
    [403.0, new Vec3(0.0188, 0.0005, 0.0891)],
    [404.0, new Vec3(0.0208, 0.0006, 0.0988)],
    [405.0, new Vec3(0.0232, 0.0006, 0.1102)],
    [406.0, new Vec3(0.0263, 0.0007, 0.1249)],
    [407.0, new Vec3(0.0298, 0.0008, 0.1418)],
    [408.0, new Vec3(0.0339, 0.0009, 0.1612)],
    [409.0, new Vec3(0.0384, 0.0011, 0.1830)],
    [410.0, new Vec3(0.0435, 0.0012, 0.2074)],
    [411.0, new Vec3(0.0489, 0.0014, 0.2334)],
    [412.0, new Vec3(0.0550, 0.0015, 0.2625)],
    [413.0, new Vec3(0.0618, 0.0017, 0.2949)],
    [414.0, new Vec3(0.0693, 0.0019, 0.3311)],
    [415.0, new Vec3(0.0776, 0.0022, 0.3713)],
    [416.0, new Vec3(0.0871, 0.0025, 0.4170)],
    [417.0, new Vec3(0.0976, 0.0028, 0.4673)],
    [418.0, new Vec3(0.1089, 0.0031, 0.5221)],
    [419.0, new Vec3(0.1212, 0.0035, 0.5815)],
    [420.0, new Vec3(0.1344, 0.0040, 0.6456)],
    [421.0, new Vec3(0.1497, 0.0046, 0.7201)],
    [422.0, new Vec3(0.1657, 0.0052, 0.7980)],
    [423.0, new Vec3(0.1820, 0.0058, 0.8780)],
    [424.0, new Vec3(0.1985, 0.0065, 0.9588)],
    [425.0, new Vec3(0.2148, 0.0073, 1.0391)],
    [426.0, new Vec3(0.2299, 0.0081, 1.1141)],
    [427.0, new Vec3(0.2445, 0.0089, 1.1868)],
    [428.0, new Vec3(0.2584, 0.0098, 1.2566)],
    [429.0, new Vec3(0.2716, 0.0107, 1.3230)],
    [430.0, new Vec3(0.2839, 0.0116, 1.3856)],
    [431.0, new Vec3(0.2948, 0.0126, 1.4419)],
    [432.0, new Vec3(0.3047, 0.0136, 1.4939)],
    [433.0, new Vec3(0.3136, 0.0146, 1.5414)],
    [434.0, new Vec3(0.3216, 0.0157, 1.5844)],
    [435.0, new Vec3(0.3285, 0.0168, 1.6230)],
    [436.0, new Vec3(0.3343, 0.0180, 1.6561)],
    [437.0, new Vec3(0.3391, 0.0192, 1.6848)],
    [438.0, new Vec3(0.3430, 0.0204, 1.7094)],
    [439.0, new Vec3(0.3461, 0.0217, 1.7301)],
    [440.0, new Vec3(0.3483, 0.0230, 1.7471)],
    [441.0, new Vec3(0.3496, 0.0243, 1.7599)],
    [442.0, new Vec3(0.3501, 0.0256, 1.7695)],
    [443.0, new Vec3(0.3500, 0.0270, 1.7763)],
    [444.0, new Vec3(0.3493, 0.0284, 1.7805)],
    [445.0, new Vec3(0.3481, 0.0298, 1.7826)],
    [446.0, new Vec3(0.3464, 0.0313, 1.7833)],
    [447.0, new Vec3(0.3444, 0.0329, 1.7823)],
    [448.0, new Vec3(0.3420, 0.0345, 1.7800)],
    [449.0, new Vec3(0.3392, 0.0362, 1.7765)],
    [450.0, new Vec3(0.3362, 0.0380, 1.7721)],
    [451.0, new Vec3(0.3333, 0.0398, 1.7688)],
    [452.0, new Vec3(0.3301, 0.0418, 1.7647)],
    [453.0, new Vec3(0.3267, 0.0438, 1.7593)],
    [454.0, new Vec3(0.3229, 0.0458, 1.7525)],
    [455.0, new Vec3(0.3187, 0.0480, 1.7441)],
    [456.0, new Vec3(0.3140, 0.0502, 1.7335)],
    [457.0, new Vec3(0.3089, 0.0526, 1.7208)],
    [458.0, new Vec3(0.3033, 0.0550, 1.7060)],
    [459.0, new Vec3(0.2973, 0.0574, 1.6889)],
    [460.0, new Vec3(0.2908, 0.0600, 1.6692)],
    [461.0, new Vec3(0.2839, 0.0626, 1.6473)],
    [462.0, new Vec3(0.2766, 0.0653, 1.6226)],
    [463.0, new Vec3(0.2687, 0.0680, 1.5946)],
    [464.0, new Vec3(0.2602, 0.0709, 1.5632)],
    [465.0, new Vec3(0.2511, 0.0739, 1.5281)],
    [466.0, new Vec3(0.2406, 0.0770, 1.4849)],
    [467.0, new Vec3(0.2297, 0.0803, 1.4386)],
    [468.0, new Vec3(0.2184, 0.0837, 1.3897)],
    [469.0, new Vec3(0.2069, 0.0872, 1.3392)],
    [470.0, new Vec3(0.1954, 0.0910, 1.2876)],
    [471.0, new Vec3(0.1844, 0.0949, 1.2382)],
    [472.0, new Vec3(0.1735, 0.0991, 1.1887)],
    [473.0, new Vec3(0.1628, 0.1034, 1.1394)],
    [474.0, new Vec3(0.1523, 0.1079, 1.0904)],
    [475.0, new Vec3(0.1421, 0.1126, 1.0419)],
    [476.0, new Vec3(0.1322, 0.1175, 0.9943)],
    [477.0, new Vec3(0.1226, 0.1226, 0.9474)],
    [478.0, new Vec3(0.1133, 0.1279, 0.9015)],
    [479.0, new Vec3(0.1043, 0.1334, 0.8567)],
    [480.0, new Vec3(0.0956, 0.1390, 0.8130)],
    [481.0, new Vec3(0.0873, 0.1446, 0.7706)],
    [482.0, new Vec3(0.0793, 0.1504, 0.7296)],
    [483.0, new Vec3(0.0718, 0.1564, 0.6902)],
    [484.0, new Vec3(0.0646, 0.1627, 0.6523)],
    [485.0, new Vec3(0.0580, 0.1693, 0.6162)],
    [486.0, new Vec3(0.0519, 0.1763, 0.5825)],
    [487.0, new Vec3(0.0463, 0.1836, 0.5507)],
    [488.0, new Vec3(0.0412, 0.1913, 0.5205)],
    [489.0, new Vec3(0.0364, 0.1994, 0.4920)],
    [490.0, new Vec3(0.0320, 0.2080, 0.4652)],
    [491.0, new Vec3(0.0279, 0.2171, 0.4399)],
    [492.0, new Vec3(0.0241, 0.2267, 0.4162)],
    [493.0, new Vec3(0.0207, 0.2368, 0.3939)],
    [494.0, new Vec3(0.0175, 0.2474, 0.3730)],
    [495.0, new Vec3(0.0147, 0.2586, 0.3533)],
    [496.0, new Vec3(0.0121, 0.2702, 0.3349)],
    [497.0, new Vec3(0.0099, 0.2824, 0.3176)],
    [498.0, new Vec3(0.0079, 0.2952, 0.3014)],
    [499.0, new Vec3(0.0063, 0.3087, 0.2862)],
    [500.0, new Vec3(0.0049, 0.3230, 0.2720)],
    [501.0, new Vec3(0.0037, 0.3385, 0.2588)],
    [502.0, new Vec3(0.0029, 0.3548, 0.2464)],
    [503.0, new Vec3(0.0024, 0.3717, 0.2346)],
    [504.0, new Vec3(0.0022, 0.3893, 0.2233)],
    [505.0, new Vec3(0.0024, 0.4073, 0.2123)],
    [506.0, new Vec3(0.0029, 0.4256, 0.2010)],
    [507.0, new Vec3(0.0038, 0.4443, 0.1899)],
    [508.0, new Vec3(0.0052, 0.4635, 0.1790)],
    [509.0, new Vec3(0.0070, 0.4830, 0.1685)],
    [510.0, new Vec3(0.0093, 0.5030, 0.1582)],
    [511.0, new Vec3(0.0122, 0.5237, 0.1481)],
    [512.0, new Vec3(0.0156, 0.5447, 0.1384)],
    [513.0, new Vec3(0.0195, 0.5658, 0.1290)],
    [514.0, new Vec3(0.0240, 0.5870, 0.1201)],
    [515.0, new Vec3(0.0291, 0.6082, 0.1117)],
    [516.0, new Vec3(0.0349, 0.6293, 0.1040)],
    [517.0, new Vec3(0.0412, 0.6502, 0.0968)],
    [518.0, new Vec3(0.0480, 0.6707, 0.0901)],
    [519.0, new Vec3(0.0554, 0.6906, 0.0839)],
    [520.0, new Vec3(0.0633, 0.7100, 0.0782)],
    [521.0, new Vec3(0.0716, 0.7280, 0.0733)],
    [522.0, new Vec3(0.0805, 0.7453, 0.0687)],
    [523.0, new Vec3(0.0898, 0.7619, 0.0646)],
    [524.0, new Vec3(0.0995, 0.7778, 0.0608)],
    [525.0, new Vec3(0.1096, 0.7932, 0.0573)],
    [526.0, new Vec3(0.1202, 0.8082, 0.0539)],
    [527.0, new Vec3(0.1311, 0.8225, 0.0507)],
    [528.0, new Vec3(0.1423, 0.8363, 0.0477)],
    [529.0, new Vec3(0.1538, 0.8495, 0.0449)],
    [530.0, new Vec3(0.1655, 0.8620, 0.0422)],
    [531.0, new Vec3(0.1772, 0.8738, 0.0395)],
    [532.0, new Vec3(0.1891, 0.8849, 0.0369)],
    [533.0, new Vec3(0.2011, 0.8955, 0.0344)],
    [534.0, new Vec3(0.2133, 0.9054, 0.0321)],
    [535.0, new Vec3(0.2257, 0.9149, 0.0298)],
    [536.0, new Vec3(0.2383, 0.9237, 0.0277)],
    [537.0, new Vec3(0.2511, 0.9321, 0.0257)],
    [538.0, new Vec3(0.2640, 0.9399, 0.0238)],
    [539.0, new Vec3(0.2771, 0.9472, 0.0220)],
    [540.0, new Vec3(0.2904, 0.9540, 0.0203)],
    [541.0, new Vec3(0.3039, 0.9602, 0.0187)],
    [542.0, new Vec3(0.3176, 0.9660, 0.0172)],
    [543.0, new Vec3(0.3314, 0.9712, 0.0159)],
    [544.0, new Vec3(0.3455, 0.9760, 0.0146)],
    [545.0, new Vec3(0.3597, 0.9803, 0.0134)],
    [546.0, new Vec3(0.3741, 0.9841, 0.0123)],
    [547.0, new Vec3(0.3886, 0.9874, 0.0113)],
    [548.0, new Vec3(0.4034, 0.9904, 0.0104)],
    [549.0, new Vec3(0.4183, 0.9929, 0.0095)],
    [550.0, new Vec3(0.4334, 0.9950, 0.0087)],
    [551.0, new Vec3(0.4488, 0.9967, 0.0080)],
    [552.0, new Vec3(0.4644, 0.9981, 0.0074)],
    [553.0, new Vec3(0.4801, 0.9992, 0.0068)],
    [554.0, new Vec3(0.4960, 0.9998, 0.0062)],
    [555.0, new Vec3(0.5121, 1.0000, 0.0057)],
    [556.0, new Vec3(0.5283, 0.9998, 0.0053)],
    [557.0, new Vec3(0.5447, 0.9993, 0.0049)],
    [558.0, new Vec3(0.5612, 0.9983, 0.0045)],
    [559.0, new Vec3(0.5778, 0.9969, 0.0042)],
    [560.0, new Vec3(0.5945, 0.9950, 0.0039)],
    [561.0, new Vec3(0.6112, 0.9926, 0.0036)],
    [562.0, new Vec3(0.6280, 0.9897, 0.0034)],
    [563.0, new Vec3(0.6448, 0.9865, 0.0031)],
    [564.0, new Vec3(0.6616, 0.9827, 0.0029)],
    [565.0, new Vec3(0.6784, 0.9786, 0.0027)],
    [566.0, new Vec3(0.6953, 0.9741, 0.0026)],
    [567.0, new Vec3(0.7121, 0.9692, 0.0024)],
    [568.0, new Vec3(0.7288, 0.9639, 0.0023)],
    [569.0, new Vec3(0.7455, 0.9581, 0.0022)],
    [570.0, new Vec3(0.7621, 0.9520, 0.0021)],
    [571.0, new Vec3(0.7785, 0.9454, 0.0020)],
    [572.0, new Vec3(0.7948, 0.9385, 0.0019)],
    [573.0, new Vec3(0.8109, 0.9312, 0.0019)],
    [574.0, new Vec3(0.8268, 0.9235, 0.0018)],
    [575.0, new Vec3(0.8425, 0.9154, 0.0018)],
    [576.0, new Vec3(0.8579, 0.9070, 0.0018)],
    [577.0, new Vec3(0.8731, 0.8983, 0.0017)],
    [578.0, new Vec3(0.8879, 0.8892, 0.0017)],
    [579.0, new Vec3(0.9023, 0.8798, 0.0017)],
    [580.0, new Vec3(0.9163, 0.8700, 0.0017)],
    [581.0, new Vec3(0.9298, 0.8598, 0.0016)],
    [582.0, new Vec3(0.9428, 0.8494, 0.0016)],
    [583.0, new Vec3(0.9553, 0.8386, 0.0015)],
    [584.0, new Vec3(0.9672, 0.8276, 0.0015)],
    [585.0, new Vec3(0.9786, 0.8163, 0.0014)],
    [586.0, new Vec3(0.9894, 0.8048, 0.0013)],
    [587.0, new Vec3(0.9996, 0.7931, 0.0013)],
    [588.0, new Vec3(1.0091, 0.7812, 0.0012)],
    [589.0, new Vec3(1.0181, 0.7692, 0.0012)],
    [590.0, new Vec3(1.0263, 0.7570, 0.0011)],
    [591.0, new Vec3(1.0340, 0.7448, 0.0011)],
    [592.0, new Vec3(1.0410, 0.7324, 0.0011)],
    [593.0, new Vec3(1.0471, 0.7200, 0.0010)],
    [594.0, new Vec3(1.0524, 0.7075, 0.0010)],
    [595.0, new Vec3(1.0567, 0.6949, 0.0010)],
    [596.0, new Vec3(1.0597, 0.6822, 0.0010)],
    [597.0, new Vec3(1.0617, 0.6695, 0.0009)],
    [598.0, new Vec3(1.0628, 0.6567, 0.0009)],
    [599.0, new Vec3(1.0630, 0.6439, 0.0008)],
    [600.0, new Vec3(1.0622, 0.6310, 0.0008)],
    [601.0, new Vec3(1.0608, 0.6182, 0.0008)],
    [602.0, new Vec3(1.0585, 0.6053, 0.0007)],
    [603.0, new Vec3(1.0552, 0.5925, 0.0007)],
    [604.0, new Vec3(1.0509, 0.5796, 0.0006)],
    [605.0, new Vec3(1.0456, 0.5668, 0.0006)],
    [606.0, new Vec3(1.0389, 0.5540, 0.0005)],
    [607.0, new Vec3(1.0313, 0.5411, 0.0005)],
    [608.0, new Vec3(1.0226, 0.5284, 0.0004)],
    [609.0, new Vec3(1.0131, 0.5157, 0.0004)],
    [610.0, new Vec3(1.0026, 0.5030, 0.0003)],
    [611.0, new Vec3(0.9914, 0.4905, 0.0003)],
    [612.0, new Vec3(0.9794, 0.4781, 0.0003)],
    [613.0, new Vec3(0.9665, 0.4657, 0.0003)],
    [614.0, new Vec3(0.9529, 0.4534, 0.0003)],
    [615.0, new Vec3(0.9384, 0.4412, 0.0002)],
    [616.0, new Vec3(0.9232, 0.4291, 0.0002)],
    [617.0, new Vec3(0.9072, 0.4170, 0.0002)],
    [618.0, new Vec3(0.8904, 0.4050, 0.0002)],
    [619.0, new Vec3(0.8728, 0.3930, 0.0002)],
    [620.0, new Vec3(0.8544, 0.3810, 0.0002)],
    [621.0, new Vec3(0.8349, 0.3689, 0.0002)],
    [622.0, new Vec3(0.8148, 0.3568, 0.0002)],
    [623.0, new Vec3(0.7941, 0.3447, 0.0001)],
    [624.0, new Vec3(0.7729, 0.3328, 0.0001)],
    [625.0, new Vec3(0.7514, 0.3210, 0.0001)],
    [626.0, new Vec3(0.7296, 0.3094, 0.0001)],
    [627.0, new Vec3(0.7077, 0.2979, 0.0001)],
    [628.0, new Vec3(0.6858, 0.2867, 0.0001)],
    [629.0, new Vec3(0.6640, 0.2757, 0.0001)],
    [630.0, new Vec3(0.6424, 0.2650, 0.0000)],
    [631.0, new Vec3(0.6217, 0.2548, 0.0000)],
    [632.0, new Vec3(0.6013, 0.2450, 0.0000)],
    [633.0, new Vec3(0.5812, 0.2354, 0.0000)],
    [634.0, new Vec3(0.5614, 0.2261, 0.0000)],
    [635.0, new Vec3(0.5419, 0.2170, 0.0000)],
    [636.0, new Vec3(0.5226, 0.2081, 0.0000)],
    [637.0, new Vec3(0.5035, 0.1995, 0.0000)],
    [638.0, new Vec3(0.4847, 0.1911, 0.0000)],
    [639.0, new Vec3(0.4662, 0.1830, 0.0000)],
    [640.0, new Vec3(0.4479, 0.1750, 0.0000)],
    [641.0, new Vec3(0.4298, 0.1672, 0.0000)],
    [642.0, new Vec3(0.4121, 0.1596, 0.0000)],
    [643.0, new Vec3(0.3946, 0.1523, 0.0000)],
    [644.0, new Vec3(0.3775, 0.1451, 0.0000)],
    [645.0, new Vec3(0.3608, 0.1382, 0.0000)],
    [646.0, new Vec3(0.3445, 0.1315, 0.0000)],
    [647.0, new Vec3(0.3286, 0.1250, 0.0000)],
    [648.0, new Vec3(0.3131, 0.1188, 0.0000)],
    [649.0, new Vec3(0.2980, 0.1128, 0.0000)],
    [650.0, new Vec3(0.2835, 0.1070, 0.0000)],
    [651.0, new Vec3(0.2696, 0.1015, 0.0000)],
    [652.0, new Vec3(0.2562, 0.0962, 0.0000)],
    [653.0, new Vec3(0.2432, 0.0911, 0.0000)],
    [654.0, new Vec3(0.2307, 0.0863, 0.0000)],
    [655.0, new Vec3(0.2187, 0.0816, 0.0000)],
    [656.0, new Vec3(0.2071, 0.0771, 0.0000)],
    [657.0, new Vec3(0.1959, 0.0728, 0.0000)],
    [658.0, new Vec3(0.1852, 0.0687, 0.0000)],
    [659.0, new Vec3(0.1748, 0.0648, 0.0000)],
    [660.0, new Vec3(0.1649, 0.0610, 0.0000)],
    [661.0, new Vec3(0.1554, 0.0574, 0.0000)],
    [662.0, new Vec3(0.1462, 0.0539, 0.0000)],
    [663.0, new Vec3(0.1375, 0.0507, 0.0000)],
    [664.0, new Vec3(0.1291, 0.0475, 0.0000)],
    [665.0, new Vec3(0.1212, 0.0446, 0.0000)],
    [666.0, new Vec3(0.1136, 0.0418, 0.0000)],
    [667.0, new Vec3(0.1065, 0.0391, 0.0000)],
    [668.0, new Vec3(0.0997, 0.0366, 0.0000)],
    [669.0, new Vec3(0.0934, 0.0342, 0.0000)],
    [670.0, new Vec3(0.0874, 0.0320, 0.0000)],
    [671.0, new Vec3(0.0819, 0.0300, 0.0000)],
    [672.0, new Vec3(0.0768, 0.0281, 0.0000)],
    [673.0, new Vec3(0.0721, 0.0263, 0.0000)],
    [674.0, new Vec3(0.0677, 0.0247, 0.0000)],
    [675.0, new Vec3(0.0636, 0.0232, 0.0000)],
    [676.0, new Vec3(0.0598, 0.0218, 0.0000)],
    [677.0, new Vec3(0.0563, 0.0205, 0.0000)],
    [678.0, new Vec3(0.0529, 0.0193, 0.0000)],
    [679.0, new Vec3(0.0498, 0.0181, 0.0000)],
    [680.0, new Vec3(0.0468, 0.0170, 0.0000)],
    [681.0, new Vec3(0.0437, 0.0159, 0.0000)],
    [682.0, new Vec3(0.0408, 0.0148, 0.0000)],
    [683.0, new Vec3(0.0380, 0.0138, 0.0000)],
    [684.0, new Vec3(0.0354, 0.0128, 0.0000)],
    [685.0, new Vec3(0.0329, 0.0119, 0.0000)],
    [686.0, new Vec3(0.0306, 0.0111, 0.0000)],
    [687.0, new Vec3(0.0284, 0.0103, 0.0000)],
    [688.0, new Vec3(0.0264, 0.0095, 0.0000)],
    [689.0, new Vec3(0.0245, 0.0088, 0.0000)],
    [690.0, new Vec3(0.0227, 0.0082, 0.0000)],
    [691.0, new Vec3(0.0211, 0.0076, 0.0000)],
    [692.0, new Vec3(0.0196, 0.0071, 0.0000)],
    [693.0, new Vec3(0.0182, 0.0066, 0.0000)],
    [694.0, new Vec3(0.0170, 0.0061, 0.0000)],
    [695.0, new Vec3(0.0158, 0.0057, 0.0000)],
    [696.0, new Vec3(0.0148, 0.0053, 0.0000)],
    [697.0, new Vec3(0.0138, 0.0050, 0.0000)],
    [698.0, new Vec3(0.0129, 0.0047, 0.0000)],
    [699.0, new Vec3(0.0121, 0.0044, 0.0000)],
    [700.0, new Vec3(0.0114, 0.0041, 0.0000)],
    [701.0, new Vec3(0.0106, 0.0038, 0.0000)],
    [702.0, new Vec3(0.0099, 0.0036, 0.0000)],
    [703.0, new Vec3(0.0093, 0.0034, 0.0000)],
    [704.0, new Vec3(0.0087, 0.0031, 0.0000)],
    [705.0, new Vec3(0.0081, 0.0029, 0.0000)],
    [706.0, new Vec3(0.0076, 0.0027, 0.0000)],
    [707.0, new Vec3(0.0071, 0.0026, 0.0000)],
    [708.0, new Vec3(0.0066, 0.0024, 0.0000)],
    [709.0, new Vec3(0.0062, 0.0022, 0.0000)],
    [710.0, new Vec3(0.0058, 0.0021, 0.0000)],
    [711.0, new Vec3(0.0054, 0.0020, 0.0000)],
    [712.0, new Vec3(0.0051, 0.0018, 0.0000)],
    [713.0, new Vec3(0.0047, 0.0017, 0.0000)],
    [714.0, new Vec3(0.0044, 0.0016, 0.0000)],
    [715.0, new Vec3(0.0041, 0.0015, 0.0000)],
    [716.0, new Vec3(0.0038, 0.0014, 0.0000)],
    [717.0, new Vec3(0.0036, 0.0013, 0.0000)],
    [718.0, new Vec3(0.0033, 0.0012, 0.0000)],
    [719.0, new Vec3(0.0031, 0.0011, 0.0000)],
    [720.0, new Vec3(0.0029, 0.0010, 0.0000)],
    [721.0, new Vec3(0.0027, 0.0010, 0.0000)],
    [722.0, new Vec3(0.0025, 0.0009, 0.0000)],
    [723.0, new Vec3(0.0024, 0.0008, 0.0000)],
    [724.0, new Vec3(0.0022, 0.0008, 0.0000)],
    [725.0, new Vec3(0.0020, 0.0007, 0.0000)],
    [726.0, new Vec3(0.0019, 0.0007, 0.0000)],
    [727.0, new Vec3(0.0018, 0.0006, 0.0000)],
    [728.0, new Vec3(0.0017, 0.0006, 0.0000)],
    [729.0, new Vec3(0.0015, 0.0006, 0.0000)],
    [730.0, new Vec3(0.0014, 0.0005, 0.0000)],
    [731.0, new Vec3(0.0013, 0.0005, 0.0000)],
    [732.0, new Vec3(0.0012, 0.0004, 0.0000)],
    [733.0, new Vec3(0.0012, 0.0004, 0.0000)],
    [734.0, new Vec3(0.0011, 0.0004, 0.0000)],
    [735.0, new Vec3(0.0010, 0.0004, 0.0000)],
    [736.0, new Vec3(0.0009, 0.0003, 0.0000)],
    [737.0, new Vec3(0.0009, 0.0003, 0.0000)],
    [738.0, new Vec3(0.0008, 0.0003, 0.0000)],
    [739.0, new Vec3(0.0007, 0.0003, 0.0000)],
    [740.0, new Vec3(0.0007, 0.0002, 0.0000)],
    [741.0, new Vec3(0.0006, 0.0002, 0.0000)],
    [742.0, new Vec3(0.0006, 0.0002, 0.0000)],
    [743.0, new Vec3(0.0006, 0.0002, 0.0000)],
    [744.0, new Vec3(0.0005, 0.0002, 0.0000)],
    [745.0, new Vec3(0.0005, 0.0002, 0.0000)],
    [746.0, new Vec3(0.0004, 0.0002, 0.0000)],
    [747.0, new Vec3(0.0004, 0.0001, 0.0000)],
    [748.0, new Vec3(0.0004, 0.0001, 0.0000)],
    [749.0, new Vec3(0.0004, 0.0001, 0.0000)],
    [750.0, new Vec3(0.0003, 0.0001, 0.0000)],
    [751.0, new Vec3(0.0003, 0.0001, 0.0000)],
    [752.0, new Vec3(0.0003, 0.0001, 0.0000)],
    [753.0, new Vec3(0.0003, 0.0001, 0.0000)],
    [754.0, new Vec3(0.0003, 0.0001, 0.0000)],
    [755.0, new Vec3(0.0002, 0.0001, 0.0000)],
    [756.0, new Vec3(0.0002, 0.0001, 0.0000)],
    [757.0, new Vec3(0.0002, 0.0001, 0.0000)],
    [758.0, new Vec3(0.0002, 0.0001, 0.0000)],
    [759.0, new Vec3(0.0002, 0.0001, 0.0000)],
    [760.0, new Vec3(0.0002, 0.0001, 0.0000)],
    [761.0, new Vec3(0.0002, 0.0001, 0.0000)],
    [762.0, new Vec3(0.0001, 0.0001, 0.0000)],
    [763.0, new Vec3(0.0001, 0.0000, 0.0000)],
    [764.0, new Vec3(0.0001, 0.0000, 0.0000)],
    [765.0, new Vec3(0.0001, 0.0000, 0.0000)],
    [766.0, new Vec3(0.0001, 0.0000, 0.0000)],
    [767.0, new Vec3(0.0001, 0.0000, 0.0000)],
    [768.0, new Vec3(0.0001, 0.0000, 0.0000)],
    [769.0, new Vec3(0.0001, 0.0000, 0.0000)],
    [770.0, new Vec3(0.0001, 0.0000, 0.0000)],
    [771.0, new Vec3(0.0001, 0.0000, 0.0000)],
    [772.0, new Vec3(0.0001, 0.0000, 0.0000)],
    [773.0, new Vec3(0.0001, 0.0000, 0.0000)],
    [774.0, new Vec3(0.0001, 0.0000, 0.0000)],
    [775.0, new Vec3(0.0001, 0.0000, 0.0000)],
    [776.0, new Vec3(0.0001, 0.0000, 0.0000)],
    [777.0, new Vec3(0.0001, 0.0000, 0.0000)],
    [778.0, new Vec3(0.0000, 0.0000, 0.0000)],
    [779.0, new Vec3(0.0000, 0.0000, 0.0000)],
    [780.0, new Vec3(0.0000, 0.0000, 0.0000)],
  ];

  static wavelengthToXYZ2012: Vec3Lookup = [
    [390, new Vec3(3.769647E-03, 4.146161E-04, 1.847260E-02)],
    [391, new Vec3(4.532416E-03, 5.028333E-04, 2.221101E-02)],
    [392, new Vec3(5.446553E-03, 6.084991E-04, 2.669819E-02)],
    [393, new Vec3(6.538868E-03, 7.344436E-04, 3.206937E-02)],
    [394, new Vec3(7.839699E-03, 8.837389E-04, 3.847832E-02)],
    [395, new Vec3(9.382967E-03, 1.059646E-03, 4.609784E-02)],
    [396, new Vec3(1.120608E-02, 1.265532E-03, 5.511953E-02)],
    [397, new Vec3(1.334965E-02, 1.504753E-03, 6.575257E-02)],
    [398, new Vec3(1.585690E-02, 1.780493E-03, 7.822113E-02)],
    [399, new Vec3(1.877286E-02, 2.095572E-03, 9.276013E-02)],
    [400, new Vec3(2.214302E-02, 2.452194E-03, 1.096090E-01)],
    [401, new Vec3(2.601285E-02, 2.852216E-03, 1.290077E-01)],
    [402, new Vec3(3.043036E-02, 3.299115E-03, 1.512047E-01)],
    [403, new Vec3(3.544325E-02, 3.797466E-03, 1.764441E-01)],
    [404, new Vec3(4.109640E-02, 4.352768E-03, 2.049517E-01)],
    [405, new Vec3(4.742986E-02, 4.971717E-03, 2.369246E-01)],
    [406, new Vec3(5.447394E-02, 5.661014E-03, 2.725123E-01)],
    [407, new Vec3(6.223612E-02, 6.421615E-03, 3.117820E-01)],
    [408, new Vec3(7.070048E-02, 7.250312E-03, 3.547064E-01)],
    [409, new Vec3(7.982513E-02, 8.140173E-03, 4.011473E-01)],
    [410, new Vec3(8.953803E-02, 9.079860E-03, 4.508369E-01)],
    [411, new Vec3(9.974848E-02, 1.005608E-02, 5.034164E-01)],
    [412, new Vec3(1.104019E-01, 1.106456E-02, 5.586361E-01)],
    [413, new Vec3(1.214566E-01, 1.210522E-02, 6.162734E-01)],
    [414, new Vec3(1.328741E-01, 1.318014E-02, 6.760982E-01)],
    [415, new Vec3(1.446214E-01, 1.429377E-02, 7.378822E-01)],
    [416, new Vec3(1.566468E-01, 1.545004E-02, 8.013019E-01)],
    [417, new Vec3(1.687901E-01, 1.664093E-02, 8.655573E-01)],
    [418, new Vec3(1.808328E-01, 1.785302E-02, 9.295791E-01)],
    [419, new Vec3(1.925216E-01, 1.907018E-02, 9.921293E-01)],
    [420, new Vec3(2.035729E-01, 2.027369E-02, 1.051821E+00)],
    [421, new Vec3(2.137531E-01, 2.144805E-02, 1.107509E+00)],
    [422, new Vec3(2.231348E-01, 2.260041E-02, 1.159527E+00)],
    [423, new Vec3(2.319245E-01, 2.374789E-02, 1.208869E+00)],
    [424, new Vec3(2.403892E-01, 2.491247E-02, 1.256834E+00)],
    [425, new Vec3(2.488523E-01, 2.612106E-02, 1.305008E+00)],
    [426, new Vec3(2.575896E-01, 2.739923E-02, 1.354758E+00)],
    [427, new Vec3(2.664991E-01, 2.874993E-02, 1.405594E+00)],
    [428, new Vec3(2.753532E-01, 3.016909E-02, 1.456414E+00)],
    [429, new Vec3(2.838921E-01, 3.165145E-02, 1.505960E+00)],
    [430, new Vec3(2.918246E-01, 3.319038E-02, 1.552826E+00)],
    [431, new Vec3(2.989200E-01, 3.477912E-02, 1.595902E+00)],
    [432, new Vec3(3.052993E-01, 3.641495E-02, 1.635768E+00)],
    [433, new Vec3(3.112031E-01, 3.809569E-02, 1.673573E+00)],
    [434, new Vec3(3.169047E-01, 3.981843E-02, 1.710604E+00)],
    [435, new Vec3(3.227087E-01, 4.157940E-02, 1.748280E+00)],
    [436, new Vec3(3.288194E-01, 4.337098E-02, 1.787504E+00)],
    [437, new Vec3(3.349242E-01, 4.517180E-02, 1.826609E+00)],
    [438, new Vec3(3.405452E-01, 4.695420E-02, 1.863108E+00)],
    [439, new Vec3(3.451688E-01, 4.868718E-02, 1.894332E+00)],
    [440, new Vec3(3.482554E-01, 5.033657E-02, 1.917479E+00)],
    [441, new Vec3(3.494153E-01, 5.187611E-02, 1.930529E+00)],
    [442, new Vec3(3.489075E-01, 5.332218E-02, 1.934819E+00)],
    [443, new Vec3(3.471746E-01, 5.470603E-02, 1.932650E+00)],
    [444, new Vec3(3.446705E-01, 5.606335E-02, 1.926395E+00)],
    [445, new Vec3(3.418483E-01, 5.743393E-02, 1.918437E+00)],
    [446, new Vec3(3.390240E-01, 5.885107E-02, 1.910430E+00)],
    [447, new Vec3(3.359926E-01, 6.030809E-02, 1.901224E+00)],
    [448, new Vec3(3.324276E-01, 6.178644E-02, 1.889000E+00)],
    [449, new Vec3(3.280157E-01, 6.326570E-02, 1.871996E+00)],
    [450, new Vec3(3.224637E-01, 6.472352E-02, 1.848545E+00)],
    [451, new Vec3(3.156225E-01, 6.614749E-02, 1.817792E+00)],
    [452, new Vec3(3.078201E-01, 6.757256E-02, 1.781627E+00)],
    [453, new Vec3(2.994771E-01, 6.904928E-02, 1.742514E+00)],
    [454, new Vec3(2.909776E-01, 7.063280E-02, 1.702749E+00)],
    [455, new Vec3(2.826646E-01, 7.238339E-02, 1.664439E+00)],
    [456, new Vec3(2.747962E-01, 7.435960E-02, 1.629207E+00)],
    [457, new Vec3(2.674312E-01, 7.659383E-02, 1.597360E+00)],
    [458, new Vec3(2.605847E-01, 7.911436E-02, 1.568896E+00)],
    [459, new Vec3(2.542749E-01, 8.195345E-02, 1.543823E+00)],
    [460, new Vec3(2.485254E-01, 8.514816E-02, 1.522157E+00)],
    [461, new Vec3(2.433039E-01, 8.872657E-02, 1.503611E+00)],
    [462, new Vec3(2.383414E-01, 9.266008E-02, 1.486673E+00)],
    [463, new Vec3(2.333253E-01, 9.689723E-02, 1.469595E+00)],
    [464, new Vec3(2.279619E-01, 1.013746E-01, 1.450709E+00)],
    [465, new Vec3(2.219781E-01, 1.060145E-01, 1.428440E+00)],
    [466, new Vec3(2.151735E-01, 1.107377E-01, 1.401587E+00)],
    [467, new Vec3(2.075619E-01, 1.155111E-01, 1.370094E+00)],
    [468, new Vec3(1.992183E-01, 1.203122E-01, 1.334220E+00)],
    [469, new Vec3(1.902290E-01, 1.251161E-01, 1.294275E+00)],
    [470, new Vec3(1.806905E-01, 1.298957E-01, 1.250610E+00)],
    [471, new Vec3(1.707154E-01, 1.346299E-01, 1.203696E+00)],
    [472, new Vec3(1.604471E-01, 1.393309E-01, 1.154316E+00)],
    [473, new Vec3(1.500244E-01, 1.440235E-01, 1.103284E+00)],
    [474, new Vec3(1.395705E-01, 1.487372E-01, 1.051347E+00)],
    [475, new Vec3(1.291920E-01, 1.535066E-01, 9.991789E-01)],
    [476, new Vec3(1.189859E-01, 1.583644E-01, 9.473958E-01)],
    [477, new Vec3(1.090615E-01, 1.633199E-01, 8.966222E-01)],
    [478, new Vec3(9.951424E-02, 1.683761E-01, 8.473981E-01)],
    [479, new Vec3(9.041850E-02, 1.735365E-01, 8.001576E-01)],
    [480, new Vec3(8.182895E-02, 1.788048E-01, 7.552379E-01)],
    [481, new Vec3(7.376817E-02, 1.841819E-01, 7.127879E-01)],
    [482, new Vec3(6.619477E-02, 1.896559E-01, 6.725198E-01)],
    [483, new Vec3(5.906380E-02, 1.952101E-01, 6.340976E-01)],
    [484, new Vec3(5.234242E-02, 2.008259E-01, 5.972433E-01)],
    [485, new Vec3(4.600865E-02, 2.064828E-01, 5.617313E-01)],
    [486, new Vec3(4.006154E-02, 2.121826E-01, 5.274921E-01)],
    [487, new Vec3(3.454373E-02, 2.180279E-01, 4.948809E-01)],
    [488, new Vec3(2.949091E-02, 2.241586E-01, 4.642586E-01)],
    [489, new Vec3(2.492140E-02, 2.307302E-01, 4.358841E-01)],
    [490, new Vec3(2.083981E-02, 2.379160E-01, 4.099313E-01)],
    [491, new Vec3(1.723591E-02, 2.458706E-01, 3.864261E-01)],
    [492, new Vec3(1.407924E-02, 2.546023E-01, 3.650566E-01)],
    [493, new Vec3(1.134516E-02, 2.640760E-01, 3.454812E-01)],
    [494, new Vec3(9.019658E-03, 2.742490E-01, 3.274095E-01)],
    [495, new Vec3(7.097731E-03, 2.850680E-01, 3.105939E-01)],
    [496, new Vec3(5.571145E-03, 2.964837E-01, 2.948102E-01)],
    [497, new Vec3(4.394566E-03, 3.085010E-01, 2.798194E-01)],
    [498, new Vec3(3.516303E-03, 3.211393E-01, 2.654100E-01)],
    [499, new Vec3(2.887638E-03, 3.344175E-01, 2.514084E-01)],
    [500, new Vec3(2.461588E-03, 3.483536E-01, 2.376753E-01)],
    [501, new Vec3(2.206348E-03, 3.629601E-01, 2.241211E-01)],
    [502, new Vec3(2.149559E-03, 3.782275E-01, 2.107484E-01)],
    [503, new Vec3(2.337091E-03, 3.941359E-01, 1.975839E-01)],
    [504, new Vec3(2.818931E-03, 4.106582E-01, 1.846574E-01)],
    [505, new Vec3(3.649178E-03, 4.277595E-01, 1.720018E-01)],
    [506, new Vec3(4.891359E-03, 4.453993E-01, 1.596918E-01)],
    [507, new Vec3(6.629364E-03, 4.635396E-01, 1.479415E-01)],
    [508, new Vec3(8.942902E-03, 4.821376E-01, 1.369428E-01)],
    [509, new Vec3(1.190224E-02, 5.011430E-01, 1.268279E-01)],
    [510, new Vec3(1.556989E-02, 5.204972E-01, 1.176796E-01)],
    [511, new Vec3(1.997668E-02, 5.401387E-01, 1.094970E-01)],
    [512, new Vec3(2.504698E-02, 5.600208E-01, 1.020943E-01)],
    [513, new Vec3(3.067530E-02, 5.800972E-01, 9.527993E-02)],
    [514, new Vec3(3.674999E-02, 6.003172E-01, 8.890075E-02)],
    [515, new Vec3(4.315171E-02, 6.206256E-01, 8.283548E-02)],
    [516, new Vec3(4.978584E-02, 6.409398E-01, 7.700982E-02)],
    [517, new Vec3(5.668554E-02, 6.610772E-01, 7.144001E-02)],
    [518, new Vec3(6.391651E-02, 6.808134E-01, 6.615436E-02)],
    [519, new Vec3(7.154352E-02, 6.999044E-01, 6.117199E-02)],
    [520, new Vec3(7.962917E-02, 7.180890E-01, 5.650407E-02)],
    [521, new Vec3(8.821473E-02, 7.351593E-01, 5.215121E-02)],
    [522, new Vec3(9.726978E-02, 7.511821E-01, 4.809566E-02)],
    [523, new Vec3(1.067504E-01, 7.663143E-01, 4.431720E-02)],
    [524, new Vec3(1.166192E-01, 7.807352E-01, 4.079734E-02)],
    [525, new Vec3(1.268468E-01, 7.946448E-01, 3.751912E-02)],
    [526, new Vec3(1.374060E-01, 8.082074E-01, 3.446846E-02)],
    [527, new Vec3(1.482471E-01, 8.213817E-01, 3.163764E-02)],
    [528, new Vec3(1.593076E-01, 8.340701E-01, 2.901901E-02)],
    [529, new Vec3(1.705181E-01, 8.461711E-01, 2.660364E-02)],
    [530, new Vec3(1.818026E-01, 8.575799E-01, 2.438164E-02)],
    [531, new Vec3(1.931090E-01, 8.682408E-01, 2.234097E-02)],
    [532, new Vec3(2.045085E-01, 8.783061E-01, 2.046415E-02)],
    [533, new Vec3(2.161166E-01, 8.879907E-01, 1.873456E-02)],
    [534, new Vec3(2.280650E-01, 8.975211E-01, 1.713788E-02)],
    [535, new Vec3(2.405015E-01, 9.071347E-01, 1.566174E-02)],
    [536, new Vec3(2.535441E-01, 9.169947E-01, 1.429644E-02)],
    [537, new Vec3(2.671300E-01, 9.269295E-01, 1.303702E-02)],
    [538, new Vec3(2.811351E-01, 9.366731E-01, 1.187897E-02)],
    [539, new Vec3(2.954164E-01, 9.459482E-01, 1.081725E-02)],
    [540, new Vec3(3.098117E-01, 9.544675E-01, 9.846470E-03)],
    [541, new Vec3(3.241678E-01, 9.619834E-01, 8.960687E-03)],
    [542, new Vec3(3.384319E-01, 9.684390E-01, 8.152811E-03)],
    [543, new Vec3(3.525786E-01, 9.738289E-01, 7.416025E-03)],
    [544, new Vec3(3.665839E-01, 9.781519E-01, 6.744115E-03)],
    [545, new Vec3(3.804244E-01, 9.814106E-01, 6.131421E-03)],
    [546, new Vec3(3.940988E-01, 9.836669E-01, 5.572778E-03)],
    [547, new Vec3(4.076972E-01, 9.852081E-01, 5.063463E-03)],
    [548, new Vec3(4.213484E-01, 9.863813E-01, 4.599169E-03)],
    [549, new Vec3(4.352003E-01, 9.875357E-01, 4.175971E-03)],
    [550, new Vec3(4.494206E-01, 9.890228E-01, 3.790291E-03)],
    [551, new Vec3(4.641616E-01, 9.910811E-01, 3.438952E-03)],
    [552, new Vec3(4.794395E-01, 9.934913E-01, 3.119341E-03)],
    [553, new Vec3(4.952180E-01, 9.959172E-01, 2.829038E-03)],
    [554, new Vec3(5.114395E-01, 9.980205E-01, 2.565722E-03)],
    [555, new Vec3(5.280233E-01, 9.994608E-01, 2.327186E-03)],
    [556, new Vec3(5.448696E-01, 9.999930E-01, 2.111280E-03)],
    [557, new Vec3(5.618898E-01, 9.997557E-01, 1.915766E-03)],
    [558, new Vec3(5.790137E-01, 9.989839E-01, 1.738589E-03)],
    [559, new Vec3(5.961882E-01, 9.979123E-01, 1.577920E-03)],
    [560, new Vec3(6.133784E-01, 9.967737E-01, 1.432128E-03)],
    [561, new Vec3(6.305897E-01, 9.957356E-01, 1.299781E-03)],
    [562, new Vec3(6.479223E-01, 9.947115E-01, 1.179667E-03)],
    [563, new Vec3(6.654866E-01, 9.935534E-01, 1.070694E-03)],
    [564, new Vec3(6.833782E-01, 9.921156E-01, 9.718623E-04)],
    [565, new Vec3(7.016774E-01, 9.902549E-01, 8.822531E-04)],
    [566, new Vec3(7.204110E-01, 9.878596E-01, 8.010231E-04)],
    [567, new Vec3(7.394495E-01, 9.849324E-01, 7.273884E-04)],
    [568, new Vec3(7.586285E-01, 9.815036E-01, 6.606347E-04)],
    [569, new Vec3(7.777885E-01, 9.776035E-01, 6.001146E-04)],
    [570, new Vec3(7.967750E-01, 9.732611E-01, 5.452416E-04)],
    [571, new Vec3(8.154530E-01, 9.684764E-01, 4.954847E-04)],
    [572, new Vec3(8.337389E-01, 9.631369E-01, 4.503642E-04)],
    [573, new Vec3(8.515493E-01, 9.571062E-01, 4.094455E-04)],
    [574, new Vec3(8.687862E-01, 9.502540E-01, 3.723345E-04)],
    [575, new Vec3(8.853376E-01, 9.424569E-01, 3.386739E-04)],
    [576, new Vec3(9.011588E-01, 9.336897E-01, 3.081396E-04)],
    [577, new Vec3(9.165278E-01, 9.242893E-01, 2.804370E-04)],
    [578, new Vec3(9.318245E-01, 9.146707E-01, 2.552996E-04)],
    [579, new Vec3(9.474524E-01, 9.052333E-01, 2.324859E-04)],
    [580, new Vec3(9.638388E-01, 8.963613E-01, 2.117772E-04)],
    [581, new Vec3(9.812596E-01, 8.883069E-01, 1.929758E-04)],
    [582, new Vec3(9.992953E-01, 8.808462E-01, 1.759024E-04)],
    [583, new Vec3(1.017343E+00, 8.736445E-01, 1.603947E-04)],
    [584, new Vec3(1.034790E+00, 8.663755E-01, 1.463059E-04)],
    [585, new Vec3(1.051011E+00, 8.587203E-01, 1.335031E-04)],
    [586, new Vec3(1.065522E+00, 8.504295E-01, 1.218660E-04)],
    [587, new Vec3(1.078421E+00, 8.415047E-01, 1.112857E-04)],
    [588, new Vec3(1.089944E+00, 8.320109E-01, 1.016634E-04)],
    [589, new Vec3(1.100320E+00, 8.220154E-01, 9.291003E-05)],
    [590, new Vec3(1.109767E+00, 8.115868E-01, 8.494468E-05)],
    [591, new Vec3(1.118438E+00, 8.007874E-01, 7.769425E-05)],
    [592, new Vec3(1.126266E+00, 7.896515E-01, 7.109247E-05)],
    [593, new Vec3(1.133138E+00, 7.782053E-01, 6.507936E-05)],
    [594, new Vec3(1.138952E+00, 7.664733E-01, 5.960061E-05)],
    [595, new Vec3(1.143620E+00, 7.544785E-01, 5.460706E-05)],
    [596, new Vec3(1.147095E+00, 7.422473E-01, 5.005417E-05)],
    [597, new Vec3(1.149464E+00, 7.298229E-01, 4.590157E-05)],
    [598, new Vec3(1.150838E+00, 7.172525E-01, 4.211268E-05)],
    [599, new Vec3(1.151326E+00, 7.045818E-01, 3.865437E-05)],
    [600, new Vec3(1.151033E+00, 6.918553E-01, 3.549661E-05)],
    [601, new Vec3(1.150002E+00, 6.791009E-01, 3.261220E-05)],
    [602, new Vec3(1.148061E+00, 6.662846E-01, 2.997643E-05)],
    [603, new Vec3(1.144998E+00, 6.533595E-01, 2.756693E-05)],
    [604, new Vec3(1.140622E+00, 6.402807E-01, 2.536339E-05)],
    [605, new Vec3(1.134757E+00, 6.270066E-01, 2.334738E-05)],
    [606, new Vec3(1.127298E+00, 6.135148E-01, 2.150221E-05)],
    [607, new Vec3(1.118342E+00, 5.998494E-01, 1.981268E-05)],
    [608, new Vec3(1.108033E+00, 5.860682E-01, 1.826500E-05)],
    [609, new Vec3(1.096515E+00, 5.722261E-01, 1.684667E-05)],
    [610, new Vec3(1.083928E+00, 5.583746E-01, 1.554631E-05)],
    [611, new Vec3(1.070387E+00, 5.445535E-01, 1.435360E-05)],
    [612, new Vec3(1.055934E+00, 5.307673E-01, 1.325915E-05)],
    [613, new Vec3(1.040592E+00, 5.170130E-01, 1.225443E-05)],
    [614, new Vec3(1.024385E+00, 5.032889E-01, 1.133169E-05)],
    [615, new Vec3(1.007344E+00, 4.895950E-01, 1.048387E-05)],
    [616, new Vec3(9.895268E-01, 4.759442E-01, 0.000000E+00)],
    [617, new Vec3(9.711213E-01, 4.623958E-01, 0.000000E+00)],
    [618, new Vec3(9.523257E-01, 4.490154E-01, 0.000000E+00)],
    [619, new Vec3(9.333248E-01, 4.358622E-01, 0.000000E+00)],
    [620, new Vec3(9.142877E-01, 4.229897E-01, 0.000000E+00)],
    [621, new Vec3(8.952798E-01, 4.104152E-01, 0.000000E+00)],
    [622, new Vec3(8.760157E-01, 3.980356E-01, 0.000000E+00)],
    [623, new Vec3(8.561607E-01, 3.857300E-01, 0.000000E+00)],
    [624, new Vec3(8.354235E-01, 3.733907E-01, 0.000000E+00)],
    [625, new Vec3(8.135565E-01, 3.609245E-01, 0.000000E+00)],
    [626, new Vec3(7.904565E-01, 3.482860E-01, 0.000000E+00)],
    [627, new Vec3(7.664364E-01, 3.355702E-01, 0.000000E+00)],
    [628, new Vec3(7.418777E-01, 3.228963E-01, 0.000000E+00)],
    [629, new Vec3(7.171219E-01, 3.103704E-01, 0.000000E+00)],
    [630, new Vec3(6.924717E-01, 2.980865E-01, 0.000000E+00)],
    [631, new Vec3(6.681600E-01, 2.861160E-01, 0.000000E+00)],
    [632, new Vec3(6.442697E-01, 2.744822E-01, 0.000000E+00)],
    [633, new Vec3(6.208450E-01, 2.631953E-01, 0.000000E+00)],
    [634, new Vec3(5.979243E-01, 2.522628E-01, 0.000000E+00)],
    [635, new Vec3(5.755410E-01, 2.416902E-01, 0.000000E+00)],
    [636, new Vec3(5.537296E-01, 2.314809E-01, 0.000000E+00)],
    [637, new Vec3(5.325412E-01, 2.216378E-01, 0.000000E+00)],
    [638, new Vec3(5.120218E-01, 2.121622E-01, 0.000000E+00)],
    [639, new Vec3(4.922070E-01, 2.030542E-01, 0.000000E+00)],
    [640, new Vec3(4.731224E-01, 1.943124E-01, 0.000000E+00)],
    [641, new Vec3(4.547417E-01, 1.859227E-01, 0.000000E+00)],
    [642, new Vec3(4.368719E-01, 1.778274E-01, 0.000000E+00)],
    [643, new Vec3(4.193121E-01, 1.699654E-01, 0.000000E+00)],
    [644, new Vec3(4.018980E-01, 1.622841E-01, 0.000000E+00)],
    [645, new Vec3(3.844986E-01, 1.547397E-01, 0.000000E+00)],
    [646, new Vec3(3.670592E-01, 1.473081E-01, 0.000000E+00)],
    [647, new Vec3(3.497167E-01, 1.400169E-01, 0.000000E+00)],
    [648, new Vec3(3.326305E-01, 1.329013E-01, 0.000000E+00)],
    [649, new Vec3(3.159341E-01, 1.259913E-01, 0.000000E+00)],
    [650, new Vec3(2.997374E-01, 1.193120E-01, 0.000000E+00)],
    [651, new Vec3(2.841189E-01, 1.128820E-01, 0.000000E+00)],
    [652, new Vec3(2.691053E-01, 1.067113E-01, 0.000000E+00)],
    [653, new Vec3(2.547077E-01, 1.008052E-01, 0.000000E+00)],
    [654, new Vec3(2.409319E-01, 9.516653E-02, 0.000000E+00)],
    [655, new Vec3(2.277792E-01, 8.979594E-02, 0.000000E+00)],
    [656, new Vec3(2.152431E-01, 8.469044E-02, 0.000000E+00)],
    [657, new Vec3(2.033010E-01, 7.984009E-02, 0.000000E+00)],
    [658, new Vec3(1.919276E-01, 7.523372E-02, 0.000000E+00)],
    [659, new Vec3(1.810987E-01, 7.086061E-02, 0.000000E+00)],
    [660, new Vec3(1.707914E-01, 6.671045E-02, 0.000000E+00)],
    [661, new Vec3(1.609842E-01, 6.277360E-02, 0.000000E+00)],
    [662, new Vec3(1.516577E-01, 5.904179E-02, 0.000000E+00)],
    [663, new Vec3(1.427936E-01, 5.550703E-02, 0.000000E+00)],
    [664, new Vec3(1.343737E-01, 5.216139E-02, 0.000000E+00)],
    [665, new Vec3(1.263808E-01, 4.899699E-02, 0.000000E+00)],
    [666, new Vec3(1.187979E-01, 4.600578E-02, 0.000000E+00)],
    [667, new Vec3(1.116088E-01, 4.317885E-02, 0.000000E+00)],
    [668, new Vec3(1.047975E-01, 4.050755E-02, 0.000000E+00)],
    [669, new Vec3(9.834835E-02, 3.798376E-02, 0.000000E+00)],
    [670, new Vec3(9.224597E-02, 3.559982E-02, 0.000000E+00)],
    [671, new Vec3(8.647506E-02, 3.334856E-02, 0.000000E+00)],
    [672, new Vec3(8.101986E-02, 3.122332E-02, 0.000000E+00)],
    [673, new Vec3(7.586514E-02, 2.921780E-02, 0.000000E+00)],
    [674, new Vec3(7.099633E-02, 2.732601E-02, 0.000000E+00)],
    [675, new Vec3(6.639960E-02, 2.554223E-02, 0.000000E+00)],
    [676, new Vec3(6.206225E-02, 2.386121E-02, 0.000000E+00)],
    [677, new Vec3(5.797409E-02, 2.227859E-02, 0.000000E+00)],
    [678, new Vec3(5.412533E-02, 2.079020E-02, 0.000000E+00)],
    [679, new Vec3(5.050600E-02, 1.939185E-02, 0.000000E+00)],
    [680, new Vec3(4.710606E-02, 1.807939E-02, 0.000000E+00)],
    [681, new Vec3(4.391411E-02, 1.684817E-02, 0.000000E+00)],
    [682, new Vec3(4.091411E-02, 1.569188E-02, 0.000000E+00)],
    [683, new Vec3(3.809067E-02, 1.460446E-02, 0.000000E+00)],
    [684, new Vec3(3.543034E-02, 1.358062E-02, 0.000000E+00)],
    [685, new Vec3(3.292138E-02, 1.261573E-02, 0.000000E+00)],
    [686, new Vec3(3.055672E-02, 1.170696E-02, 0.000000E+00)],
    [687, new Vec3(2.834146E-02, 1.085608E-02, 0.000000E+00)],
    [688, new Vec3(2.628033E-02, 1.006476E-02, 0.000000E+00)],
    [689, new Vec3(2.437465E-02, 9.333376E-03, 0.000000E+00)],
    [690, new Vec3(2.262306E-02, 8.661284E-03, 0.000000E+00)],
    [691, new Vec3(2.101935E-02, 8.046048E-03, 0.000000E+00)],
    [692, new Vec3(1.954647E-02, 7.481130E-03, 0.000000E+00)],
    [693, new Vec3(1.818727E-02, 6.959987E-03, 0.000000E+00)],
    [694, new Vec3(1.692727E-02, 6.477070E-03, 0.000000E+00)],
    [695, new Vec3(1.575417E-02, 6.027677E-03, 0.000000E+00)],
    [696, new Vec3(1.465854E-02, 5.608169E-03, 0.000000E+00)],
    [697, new Vec3(1.363571E-02, 5.216691E-03, 0.000000E+00)],
    [698, new Vec3(1.268205E-02, 4.851785E-03, 0.000000E+00)],
    [699, new Vec3(1.179394E-02, 4.512008E-03, 0.000000E+00)],
    [700, new Vec3(1.096778E-02, 4.195941E-03, 0.000000E+00)],
    [701, new Vec3(1.019964E-02, 3.902057E-03, 0.000000E+00)],
    [702, new Vec3(9.484317E-03, 3.628371E-03, 0.000000E+00)],
    [703, new Vec3(8.816851E-03, 3.373005E-03, 0.000000E+00)],
    [704, new Vec3(8.192921E-03, 3.134315E-03, 0.000000E+00)],
    [705, new Vec3(7.608750E-03, 2.910864E-03, 0.000000E+00)],
    [706, new Vec3(7.061391E-03, 2.701528E-03, 0.000000E+00)],
    [707, new Vec3(6.549509E-03, 2.505796E-03, 0.000000E+00)],
    [708, new Vec3(6.071970E-03, 2.323231E-03, 0.000000E+00)],
    [709, new Vec3(5.627476E-03, 2.153333E-03, 0.000000E+00)],
    [710, new Vec3(5.214608E-03, 1.995557E-03, 0.000000E+00)],
    [711, new Vec3(4.831848E-03, 1.849316E-03, 0.000000E+00)],
    [712, new Vec3(4.477579E-03, 1.713976E-03, 0.000000E+00)],
    [713, new Vec3(4.150166E-03, 1.588899E-03, 0.000000E+00)],
    [714, new Vec3(3.847988E-03, 1.473453E-03, 0.000000E+00)],
    [715, new Vec3(3.569452E-03, 1.367022E-03, 0.000000E+00)],
    [716, new Vec3(3.312857E-03, 1.268954E-03, 0.000000E+00)],
    [717, new Vec3(3.076022E-03, 1.178421E-03, 0.000000E+00)],
    [718, new Vec3(2.856894E-03, 1.094644E-03, 0.000000E+00)],
    [719, new Vec3(2.653681E-03, 1.016943E-03, 0.000000E+00)],
    [720, new Vec3(2.464821E-03, 9.447269E-04, 0.000000E+00)],
    [721, new Vec3(2.289060E-03, 8.775171E-04, 0.000000E+00)],
    [722, new Vec3(2.125694E-03, 8.150438E-04, 0.000000E+00)],
    [723, new Vec3(1.974121E-03, 7.570755E-04, 0.000000E+00)],
    [724, new Vec3(1.833723E-03, 7.033755E-04, 0.000000E+00)],
    [725, new Vec3(1.703876E-03, 6.537050E-04, 0.000000E+00)],
    [726, new Vec3(1.583904E-03, 6.078048E-04, 0.000000E+00)],
    [727, new Vec3(1.472939E-03, 5.653435E-04, 0.000000E+00)],
    [728, new Vec3(1.370151E-03, 5.260046E-04, 0.000000E+00)],
    [729, new Vec3(1.274803E-03, 4.895061E-04, 0.000000E+00)],
    [730, new Vec3(1.186238E-03, 4.555970E-04, 0.000000E+00)],
    [731, new Vec3(1.103871E-03, 4.240548E-04, 0.000000E+00)],
    [732, new Vec3(1.027194E-03, 3.946860E-04, 0.000000E+00)],
    [733, new Vec3(9.557493E-04, 3.673178E-04, 0.000000E+00)],
    [734, new Vec3(8.891262E-04, 3.417941E-04, 0.000000E+00)],
    [735, new Vec3(8.269535E-04, 3.179738E-04, 0.000000E+00)],
    [736, new Vec3(7.689351E-04, 2.957441E-04, 0.000000E+00)],
    [737, new Vec3(7.149425E-04, 2.750558E-04, 0.000000E+00)],
    [738, new Vec3(6.648590E-04, 2.558640E-04, 0.000000E+00)],
    [739, new Vec3(6.185421E-04, 2.381142E-04, 0.000000E+00)],
    [740, new Vec3(5.758303E-04, 2.217445E-04, 0.000000E+00)],
    [741, new Vec3(5.365046E-04, 2.066711E-04, 0.000000E+00)],
    [742, new Vec3(5.001842E-04, 1.927474E-04, 0.000000E+00)],
    [743, new Vec3(4.665005E-04, 1.798315E-04, 0.000000E+00)],
    [744, new Vec3(4.351386E-04, 1.678023E-04, 0.000000E+00)],
    [745, new Vec3(4.058303E-04, 1.565566E-04, 0.000000E+00)],
    [746, new Vec3(3.783733E-04, 1.460168E-04, 0.000000E+00)],
    [747, new Vec3(3.526892E-04, 1.361535E-04, 0.000000E+00)],
    [748, new Vec3(3.287199E-04, 1.269451E-04, 0.000000E+00)],
    [749, new Vec3(3.063998E-04, 1.183671E-04, 0.000000E+00)],
    [750, new Vec3(2.856577E-04, 1.103928E-04, 0.000000E+00)],
    [751, new Vec3(2.664108E-04, 1.029908E-04, 0.000000E+00)],
    [752, new Vec3(2.485462E-04, 9.611836E-05, 0.000000E+00)],
    [753, new Vec3(2.319529E-04, 8.973323E-05, 0.000000E+00)],
    [754, new Vec3(2.165300E-04, 8.379694E-05, 0.000000E+00)],
    [755, new Vec3(2.021853E-04, 7.827442E-05, 0.000000E+00)],
    [756, new Vec3(1.888338E-04, 7.313312E-05, 0.000000E+00)],
    [757, new Vec3(1.763935E-04, 6.834142E-05, 0.000000E+00)],
    [758, new Vec3(1.647895E-04, 6.387035E-05, 0.000000E+00)],
    [759, new Vec3(1.539542E-04, 5.969389E-05, 0.000000E+00)],
    [760, new Vec3(1.438270E-04, 5.578862E-05, 0.000000E+00)],
    [761, new Vec3(1.343572E-04, 5.213509E-05, 0.000000E+00)],
    [762, new Vec3(1.255141E-04, 4.872179E-05, 0.000000E+00)],
    [763, new Vec3(1.172706E-04, 4.553845E-05, 0.000000E+00)],
    [764, new Vec3(1.095983E-04, 4.257443E-05, 0.000000E+00)],
    [765, new Vec3(1.024685E-04, 3.981884E-05, 0.000000E+00)],
    [766, new Vec3(9.584715E-05, 3.725877E-05, 0.000000E+00)],
    [767, new Vec3(8.968316E-05, 3.487467E-05, 0.000000E+00)],
    [768, new Vec3(8.392734E-05, 3.264765E-05, 0.000000E+00)],
    [769, new Vec3(7.853708E-05, 3.056140E-05, 0.000000E+00)],
    [770, new Vec3(7.347551E-05, 2.860175E-05, 0.000000E+00)],
    [771, new Vec3(6.871576E-05, 2.675841E-05, 0.000000E+00)],
    [772, new Vec3(6.425257E-05, 2.502943E-05, 0.000000E+00)],
    [773, new Vec3(6.008292E-05, 2.341373E-05, 0.000000E+00)],
    [774, new Vec3(5.620098E-05, 2.190914E-05, 0.000000E+00)],
    [775, new Vec3(5.259870E-05, 2.051259E-05, 0.000000E+00)],
    [776, new Vec3(4.926279E-05, 1.921902E-05, 0.000000E+00)],
    [777, new Vec3(4.616623E-05, 1.801796E-05, 0.000000E+00)],
    [778, new Vec3(4.328212E-05, 1.689899E-05, 0.000000E+00)],
    [779, new Vec3(4.058715E-05, 1.585309E-05, 0.000000E+00)],
    [780, new Vec3(3.806114E-05, 1.487243E-05, 0.000000E+00)],
    [781, new Vec3(3.568818E-05, 1.395085E-05, 0.000000E+00)],
    [782, new Vec3(3.346023E-05, 1.308528E-05, 0.000000E+00)],
    [783, new Vec3(3.137090E-05, 1.227327E-05, 0.000000E+00)],
    [784, new Vec3(2.941371E-05, 1.151233E-05, 0.000000E+00)],
    [785, new Vec3(2.758222E-05, 1.080001E-05, 0.000000E+00)],
    [786, new Vec3(2.586951E-05, 1.013364E-05, 0.000000E+00)],
    [787, new Vec3(2.426701E-05, 9.509919E-06, 0.000000E+00)],
    [788, new Vec3(2.276639E-05, 8.925630E-06, 0.000000E+00)],
    [789, new Vec3(2.136009E-05, 8.377852E-06, 0.000000E+00)],
    [790, new Vec3(2.004122E-05, 7.863920E-06, 0.000000E+00)],
    [791, new Vec3(1.880380E-05, 7.381539E-06, 0.000000E+00)],
    [792, new Vec3(1.764358E-05, 6.929096E-06, 0.000000E+00)],
    [793, new Vec3(1.655671E-05, 6.505136E-06, 0.000000E+00)],
    [794, new Vec3(1.553939E-05, 6.108221E-06, 0.000000E+00)],
    [795, new Vec3(1.458792E-05, 5.736935E-06, 0.000000E+00)],
    [796, new Vec3(1.369853E-05, 5.389831E-06, 0.000000E+00)],
    [797, new Vec3(1.286705E-05, 5.065269E-06, 0.000000E+00)],
    [798, new Vec3(1.208947E-05, 4.761667E-06, 0.000000E+00)],
    [799, new Vec3(1.136207E-05, 4.477561E-06, 0.000000E+00)],
    [800, new Vec3(1.068141E-05, 4.211597E-06, 0.000000E+00)],
    [801, new Vec3(1.004411E-05, 3.962457E-06, 0.000000E+00)],
    [802, new Vec3(9.446399E-06, 3.728674E-06, 0.000000E+00)],
    [803, new Vec3(8.884754E-06, 3.508881E-06, 0.000000E+00)],
    [804, new Vec3(8.356050E-06, 3.301868E-06, 0.000000E+00)],
    [805, new Vec3(7.857521E-06, 3.106561E-06, 0.000000E+00)],
    [806, new Vec3(7.386996E-06, 2.922119E-06, 0.000000E+00)],
    [807, new Vec3(6.943576E-06, 2.748208E-06, 0.000000E+00)],
    [808, new Vec3(6.526548E-06, 2.584560E-06, 0.000000E+00)],
    [809, new Vec3(6.135087E-06, 2.430867E-06, 0.000000E+00)],
    [810, new Vec3(5.768284E-06, 2.286786E-06, 0.000000E+00)],
    [811, new Vec3(5.425069E-06, 2.151905E-06, 0.000000E+00)],
    [812, new Vec3(5.103974E-06, 2.025656E-06, 0.000000E+00)],
    [813, new Vec3(4.803525E-06, 1.907464E-06, 0.000000E+00)],
    [814, new Vec3(4.522350E-06, 1.796794E-06, 0.000000E+00)],
    [815, new Vec3(4.259166E-06, 1.693147E-06, 0.000000E+00)],
    [816, new Vec3(4.012715E-06, 1.596032E-06, 0.000000E+00)],
    [817, new Vec3(3.781597E-06, 1.504903E-06, 0.000000E+00)],
    [818, new Vec3(3.564496E-06, 1.419245E-06, 0.000000E+00)],
    [819, new Vec3(3.360236E-06, 1.338600E-06, 0.000000E+00)],
    [820, new Vec3(3.167765E-06, 1.262556E-06, 0.000000E+00)],
    [821, new Vec3(2.986206E-06, 1.190771E-06, 0.000000E+00)],
    [822, new Vec3(2.814999E-06, 1.123031E-06, 0.000000E+00)],
    [823, new Vec3(2.653663E-06, 1.059151E-06, 0.000000E+00)],
    [824, new Vec3(2.501725E-06, 9.989507E-07, 0.000000E+00)],
    [825, new Vec3(2.358723E-06, 9.422514E-07, 0.000000E+00)],
    [826, new Vec3(2.224206E-06, 8.888804E-07, 0.000000E+00)],
    [827, new Vec3(2.097737E-06, 8.386690E-07, 0.000000E+00)],
    [828, new Vec3(1.978894E-06, 7.914539E-07, 0.000000E+00)],
    [829, new Vec3(1.867268E-06, 7.470770E-07, 0.000000E+00)],
    [830, new Vec3(1.762465E-06, 7.053860E-07, 0.000000E+00)],
  ];
}